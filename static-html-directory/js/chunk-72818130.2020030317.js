(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72818130"],{"24ea":function(t,e,a){},"2c36":function(t,e,a){},3516:function(t,e,a){"use strict";var i=a("2c36"),s=a.n(i);s.a},"3fa2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"holiday"},[a("div",{staticClass:"headerSelect"},[a("vs-select",{staticClass:"selectExample",attrs:{autocomplete:""},model:{value:t.selectYear,callback:function(e){t.selectYear=e},expression:"selectYear"}},t._l(t.years,function(t,e){return a("vs-select-item",{key:e,attrs:{value:t.value,text:t.key}})}),1)],1),a("div",{staticClass:"holidayTable"},[a("TableMultipleSelected",{staticClass:"tables",attrs:{titleName:t.titleName,tableName:t.tableName,tableList:t.showHolidays}}),a("div",{staticClass:"paginations"},[a("vs-pagination",{attrs:{total:t.holidayTotal,goto:""},model:{value:t.currentx,callback:function(e){t.currentx=e},expression:"currentx"}})],1)],1),a("div",{staticClass:"holidayTable"},[a("div",{staticClass:"account-add-remove"},[a("span",{staticClass:"account-add",attrs:{title:"添加"},on:{click:t.addData}},[a("Icon",{attrs:{type:"md-add"}})],1),a("span",{staticClass:"account-add",attrs:{title:"删除"},on:{click:t.deleteMultiple}},[a("Icon",{attrs:{type:"md-remove"}})],1)]),a("TableMultipleSelected",{staticClass:"tables",attrs:{isMultiple:!0,titleName:t.titleName2,tableName:t.tableName2,tableList:t.showEvents},on:{tableData:t.tableData,removeData:t.removeData,tableSelect:t.tableSelect}}),a("div",{staticClass:"paginations"},[a("vs-pagination",{attrs:{total:t.eventTotal,goto:""},model:{value:t.currentActive,callback:function(e){t.currentActive=e},expression:"currentActive"}})],1)],1),t.isEdit?a("holidayEdit",{ref:"editActive",on:{initData:t.initData,closeEdit:t.closeEdit,editData:t.editData,showAlert:t.showAlert}}):t._e(),t.isAlert?a("alert",{attrs:{alertText:t.alertText},on:{closeAlert:t.closeAlert,alertConfirm:t.alertConfirm}}):t._e()],1)},s=[],l=(a("ac6a"),a("c5f6"),a("c1df"),a("693f")),r=a("2dc0"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"holidayEdit"},[a("div",{staticClass:"account-edit"},[a("div",{staticClass:"account-edit-bg",on:{click:t.closeEdit}}),a("div",{staticClass:"account-edit-text"},[a("div",{staticClass:"edit-title"},[t._v("\r\n                "+t._s(t.msgTitle)+"\r\n            ")]),a("div",{staticClass:"edit-close",on:{click:t.closeEdit}},[a("Icon",{attrs:{type:"md-close"}})],1),a("div",{staticClass:"edit-text"},[a("Form",{ref:"formInline",attrs:{model:t.datas,rules:t.ruleInline,"label-position":"right",inline:"","label-width":80}},[a("FormItem",{attrs:{prop:"name",label:"名称"}},[a("Input",{staticStyle:{width:"218px"},model:{value:t.datas.name,callback:function(e){t.$set(t.datas,"name",e)},expression:"datas.name"}})],1),a("FormItem",{attrs:{prop:"begin",label:"开始日期"}},[a("DatePicker",{staticStyle:{width:"218px"},attrs:{format:"yyyy-MM-dd",editable:!1,type:"date",placeholder:"选择日期"},on:{"on-change":t.beginDateDidChange},model:{value:t.datas.begin,callback:function(e){t.$set(t.datas,"begin",e)},expression:"datas.begin"}})],1),a("FormItem",{attrs:{prop:"end",label:"结束日期"}},[a("DatePicker",{staticStyle:{width:"218px"},attrs:{format:"yyyy-MM-dd",type:"date",editable:!1,placeholder:"选择日期"},on:{"on-change":t.endDateDidChange},model:{value:t.datas.end,callback:function(e){t.$set(t.datas,"end",e)},expression:"datas.end"}})],1),a("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.showBelong,expression:"showBelong"}],staticClass:"belongs",attrs:{prop:"property",label:"活动归属"}},[a("i-select",{staticStyle:{width:"218px"},model:{value:t.datas.property,callback:function(e){t.$set(t.datas,"property",e)},expression:"datas.property"}},t._l(t.propertyList,function(e){return a("i-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),a("FormItem",{attrs:{prop:"target_enter",label:"目标客流"}},[a("Input",{staticStyle:{width:"218px"},attrs:{type:"number"},model:{value:t.datas.target_enter,callback:function(e){t.$set(t.datas,"target_enter",e)},expression:"datas.target_enter"}})],1),a("FormItem",{staticStyle:{"margin-top":"12px"},attrs:{prop:"description",label:"描述"}},[a("Input",{staticStyle:{width:"218px"},attrs:{type:"textarea"},model:{value:t.datas.description,callback:function(e){t.$set(t.datas,"description",e)},expression:"datas.description"}})],1),a("FormItem",{staticStyle:{"margin-bottom":"0px","margin-left":"20px"}},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formInline")}}},[t._v("保存")]),a("Button",{staticClass:"buttonCel",on:{click:t.closeEdit}},[t._v("取消")])],1)],1)],1)]),t.isAlert?a("alert",{attrs:{alertText:t.alertText},on:{closeAlert:t.closeAlert,alertConfirm:t.alertConfirm}}):t._e()],1)])},o=[],c=(a("a481"),a("7f7f"),a("c276")),d=a("e285"),u=a("ad00"),h={name:"editHoliday",props:{editData:Object},components:{alert:r["a"]},created:function(){var t=this;Object(u["e"])().then(function(e){if(200==e.data.code){var a=[],i=e.data.data.property,s=t.$store.state.user.role_id;if(s<3)i.map(function(t){var e={};e.name=t.name,e.label=t.name,e.value=t.property_id,e.id=t.property_id,a.push(e)});else{var l=t.$store.state.user.checklist;i.map(function(t){if(l.indexOf(t.property_id)>-1){var e={};e.name=t.name,e.label=t.name,e.value=t.property_id,e.id=t.property_id,a.push(e)}})}t.propertyList=a}})},mounted:function(){},data:function(){var t=function(t,e,a){void 0===e||""===e?a(new Error("请选择")):a()},e=function(t,e,a){void 0===e||""===e||"NaN-NaN-NaN"===e?a(new Error("请选择")):a()};return{propertyList:[],isUpdate:!1,isAlert:!1,alertText:{title:"",text:"",bg:"",confirm:!1},activePrompt:!0,showEdit:!1,msgTitle:"添加活动",color:"primary",showBelong:!1,datas:{name:"",begin:"",end:"",target_enter:"",description:"",property:""},ruleInline:{name:[{required:!0,validator:c["s"],trigger:"blur"}],begin:[{required:!0,validator:e,trigger:"change"}],end:[{required:!0,validator:e,trigger:"change"}],property:[{required:!0,validator:t,trigger:"change"}],description:[{required:!1,validator:c["t"],trigger:"blur"}]}}},computed:{},methods:{formatDate:function(t){var e=new Date(t),a=e.getFullYear(),i=Number(e.getMonth()+1)>=10?e.getMonth()+1:"0"+(e.getMonth()+1),s=Number(e.getDate())>=10?e.getDate():"0"+e.getDate();return a+"-"+i+"-"+s},handleSubmit:function(t){var e=this.formatDate(this.datas.begin);e=e.indexOf("NaN")>-1?"":e,this.datas.begin=e;var a=this.formatDate(this.datas.end);a=a.indexOf("NaN")>-1?"":a,this.datas.end=a;var i=Number(e.replace("-","").replace("-","")),s=Number(a.replace("-","").replace("-","")),l=this;l.$refs[t].validate(function(t){if(t){if(i>s)return l.isAlert=!0,l.alertText.bg="#00A0E9",l.alertText.title="编辑活动",l.alertText.text="开始日期不能大于结束日期",l.alertText.confirm=!1,Object(r["a"])(""),!1;l.mok(l.datas)}})},cancel:function(){this.showEdit=!1},endDateDidChange:function(t,e){this.datas.end=t},beginDateDidChange:function(t,e){this.datas.begin=t},alertConfirm:function(t){var e=this;1==t?e.$emit("editData"):e.isAlert=!1},closeEdit:function(){this.$emit("closeEdit")},mok:function(t){var e=this,a=t;if(a.end=a.end+" 23:59:59",a.property_id=a.property,e.isUpdate&&Object(d["r"])(a).then(function(t){200===t.data.code?t.data.message.length>0?(e.isAlert=!0,e.alertText.bg="#00A0E9",e.alertText.title="编辑活动",e.alertText.text="活动名称已存在,请修改",e.alertText.confirm=!1):(e.$emit("closeEdit"),e.$emit("showAlert",!0,"#00A0E9","编辑活动","修改活动成功",!1),e.$emit("initData",21,!1)):Object(r["a"])(t.data.message)}),!e.isUpdate){a=_.cloneDeep(this.datas);a.property_id=a.property,a.type_id=21,a.date=e.selectyear,Object(d["a"])(a).then(function(t){200===t.data.code?t.data.message.length>0?(e.isAlert=!0,e.alertText.bg="#00A0E9",e.alertText.title="添加活动",e.alertText.text="活动名称已存在,请修改",e.alertText.confirm=!1):(e.$emit("closeEdit"),e.$emit("showAlert",!0,"#00A0E9","添加活动","添加活动",!1),e.$emit("initData",21,!1)):Object(r["a"])(t.data.message)})}}}},p=h,m=(a("3516"),a("2877")),f=Object(m["a"])(p,n,o,!1,null,null,null),v=f.exports,g={components:{TableMultipleSelected:l["a"],holidayEdit:v,alert:r["a"]},data:function(){return{titleName:"节假日活动管理",tableName:["节假日名称","开始时间","结束时间","持续时间"],titleName2:"活动管理",tableName2:["节假日名称","活动归属","目标客流","开始时间","结束时间","持续时间","操作"],showHolidays:[],showEvents:[],holidayAllData:[],eventAllData:[],selectYear:(new Date).getFullYear(),holidayTotal:1,eventTotal:1,currentx:1,currentActive:1,years:[],isEdit:!1,isAlert:!1,alertText:{title:"",text:"",bg:"",confirm:!1},id:"",currentPropertyId:"",selected:[],deleteSelect:"multiple"}},watch:{"$store.state.home.headerAction":function(){this.currentPropertyId=this.$store.state.home.headerAction,this.initData(21,!0)},currentx:function(t){var e=_.cloneDeep(this.holidayAllData);this.showHolidays=e.splice(5*(this.currentx-1),5),this.$nextTick(function(){document.getElementsByClassName("vs-pagination--input-goto")[1].value=t})},currentActive:function(t){var e=_.cloneDeep(this.eventAllData);this.showEvents=e.splice(5*(this.currentActive-1),5),this.$nextTick(function(){document.getElementsByClassName("vs-pagination--input-goto")[2].value=t})},selectYear:{handler:function(t,e){t&&(this.initData(20,!0),this.initData(21,!0))},immediate:!1}},mounted:function(){this.currentPropertyId=this.$store.state.home.headerAction,this.years=Object(c["w"])(),this.initData(20,!0),this.initData(21,!0)},methods:{editData:function(){this.isEdit=!1},addData:function(){this.isEdit=!0;var t={name:"",begin:"",end:"",description:""},e=this,a=e.$store.state.user.checklist;this.$nextTick(function(){e.$refs.editActive.isAlert=!1,e.$refs.editActive.datas=t,e.$refs.editActive.isUpdate=!1,e.$refs.editActive.msgTitle="添加活动",e.$store.state.user.role_id<3?e.$refs.editActive.showBelong=!0:(e.$refs.editActive.showBelong=a.length>1,e.$refs.editActive.showBelong||(e.$refs.editActive.datas.property=Number(e.$store.state.home.headerAction)))})},closeEdit:function(){this.isEdit=!1},closeAlert:function(){this.isAlert=!1},showAlert:function(t,e,a,i,s){var l=this;l.isAlert=t,l.alertText.bg=e,l.alertText.title=a,l.alertText.text=i,l.alertText.confirm=s},tableData:function(t){this.isEdit=!0;var e=this,a=e.$store.state.user.checklist;this.$nextTick(function(){e.$refs.editActive.isAlert=!1,e.$refs.editActive.datas=_.cloneDeep(t.data),e.$refs.editActive.datas.property=e.$refs.editActive.datas.property_id,e.$refs.editActive.isUpdate=!0,e.$refs.editActive.msgTitle="编辑活动",e.$store.state.user.role_id<3?e.$refs.editActive.showBelong=!0:e.$refs.editActive.showBelong=a.length>1})},alertConfirm:function(t){var e=this,a=this;if(1==t)if(a.isAlert=!1,"single"==this.deleteSelect){var i=this.id;Object(d["g"])(i).then(function(t){200===t.data.code?(a.isAlert=!0,a.alertText.bg="#00A0E9",a.alertText.title="删除活动管理",a.alertText.text="删除成功",a.alertText.confirm=!1,a.initData(21,!1)):Object(r["a"])(t.data.message)})}else{var s=this.selected.length;this.selected.forEach(function(t){Object(d["g"])(t.id).then(function(t){200==t.data.code&&(e.selected.splice(0,e.selected.length),s--,0==s&&(e.isAlert=!0,e.alertList("删除活动管理","删除成功","#00A0E9",!1),e.initData(21,!1)))})})}else this.isAlert=!1},removeData:function(t){this.id=t.data.id,this.alertText.title="删除活动",this.alertText.text="确认删除此活动信息？",this.alertText.bg="#00A0E9",this.alertText.confirm=!0,this.isAlert=!0,this.accountText=t,this.deleteSelect="single"},tableSelect:function(t){this.selected=t},deleteMultiple:function(){0==this.selected.length?(this.isAlert=!0,this.alertList("删除活动管理","删除活动管理请选择最少一个！","#00A0E9",!1)):(this.isAlert=!0,this.alertList("删除活动管理","确定要删除所选中的活动管理？","#00A0E9",!0),this.deleteSelect="multiple")},alertList:function(t,e,a,i){this.alertText.title=t,this.alertText.text=e,this.alertText.bg=a,this.alertText.confirm=i},initData:function(t,e){var a=this,i=this;if(20===t)Object(d["l"])(i.selectYear,20).then(function(t){if(200===t.data.code){i.loading=!1;var a=t.data.data;i.holidayAllData=_.cloneDeep(a),a.forEach(function(t){t.duration="".concat(t.duration,"天")}),i.holidayTotal=Math.ceil(a.length/5),i.holidays=_.clone(a),e?(i.showHolidays=a.splice(0,5),i.currentx=1):i.showHolidays=a.splice(5*(i.currentx-1),5)}else i.showHolidays=[],i.holidayTotal=1}).catch(function(t){});else if(21===t){var s=[];Object(d["l"])(i.selectYear,21,0).then(function(t){t=t.data.data,t.forEach(function(t){t.operation=!0,t.duration="".concat(t.duration,"天"),t.enterGoal=t.property_name||" ",0==t.target_enter?t.saleGoal=0:t.saleGoal=t.target_enter||" ",s.push(t)}),a.eventAllData=_.cloneDeep(s),a.eventTotal=Math.ceil(a.eventAllData.length/5),e?(a.showEvents=s.splice(0,5),a.currentActive=1):(a.showEvents=s.splice(5*(a.currentActive-1),5),a.eventAllData.length>0&&0===a.showEvents.length&&(a.currentActive--,a.showEvents=s.splice(5*(a.currentActive-1),5)))}).catch(function(t){i.showEvents=[],i.eventTotal=1})}}}},b=g,x=(a("44c6"),Object(m["a"])(b,i,s,!1,null,null,null));e["default"]=x.exports},"44c6":function(t,e,a){"use strict";var i=a("24ea"),s=a.n(i);s.a}}]);