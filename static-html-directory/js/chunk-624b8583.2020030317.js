(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-624b8583"],{"109a":function(t,e,a){"use strict";var r=a("d913"),i=a.n(r);i.a},"134d":function(t,e,a){},"36af":function(t,e,a){},"4ce9":function(t,e,a){"use strict";var r=a("ce77"),i=a.n(r);i.a},"4ee1f":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vs-table",{attrs:{data:t.data,maxHeight:"400px",noDataText:t.noData,id:"i-table-component"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.data;return t._l(r,function(e,r){return a("vs-tr",{key:r},t._l(t.columns,function(r,i){return a("vs-td",{key:i},[t._v(t._s(e[r.key]&&e[r.key].toLocaleString()))])}),1)})}}])},[a("template",{slot:"header"},[t._t("head")],2),a("template",{slot:"thead"},t._l(t.columns,function(e,r){return a("vs-th",{key:r},[t._v(t._s(e.title))])}),1)],2)},i=[],n={props:{columns:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},noData:{type:String,default:"暂无数据"}}},s=n,o=(a("4ce9"),a("2877")),l=Object(o["a"])(s,r,i,!1,null,"699f3333",null);e["a"]=l.exports},"63d9":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vx-card",{staticClass:"headline",attrs:{title:t.tableTitle}},[a("vs-table",{attrs:{data:t.tableList,noDataText:t.name},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.data;return t._l(r,function(e,i){return a("vs-tr",{key:i},[r[i].name?a("vs-td",{attrs:{data:r[i].name}},[t._v("\n          "+t._s(r[i].name)+"\n        ")]):t._e(),r[i].type?a("vs-td",{attrs:{data:r[i].type}},[t._v("\n          "+t._s(r[i].type)+"\n        ")]):t._e(),r[i].time?a("vs-td",{attrs:{data:r[i].time}},[t._v("\n          "+t._s(r[i].time)+"\n        ")]):t._e(),r[i].avg?a("vs-td",{attrs:{data:r[i].avg}},[t._v("\n          "+t._s(r[i].avg)+"\n        ")]):t._e(),r[i].enter?a("vs-td",{attrs:{data:r[i].enter}},[t._v("\n          "+t._s(r[i].enter)+"\n        ")]):t._e(),r[i].percent?a("vs-td",{attrs:{data:r[i].percent}},[t._v("\n          "+t._s(r[i].percent)+"%\n        ")]):t._e(),t._l(r[i].percentList,function(e,n){return r[i].percentList?a("vs-td",{key:n,attrs:{data:r[i].percentList}},[t._v("\n          "+t._s(e)+"\n        ")]):t._e()})],2)})}}])},[a("template",{slot:"thead"},t._l(t.tableName,function(e,r){return a("vs-th",{key:r,staticClass:"table-title"},[t._v(t._s(e))])}),1)],2)],1)},i=[],n={name:"dwell-time-table",props:{tableTitle:{type:String,default:""},tableName:{type:Array,default:[]},tableList:{type:Array,default:[]}},data:function(){return{name:"暂无数据"}}},s=n,o=(a("99d7"),a("2877")),l=Object(o["a"])(s,r,i,!1,null,null,null);e["a"]=l.exports},"94b0":function(t,e,a){"use strict";a.d(e,"e",function(){return s}),a.d(e,"h",function(){return o}),a.d(e,"d",function(){return l}),a.d(e,"r",function(){return c}),a.d(e,"f",function(){return u}),a.d(e,"l",function(){return d}),a.d(e,"b",function(){return p}),a.d(e,"p",function(){return m}),a.d(e,"q",function(){return h}),a.d(e,"g",function(){return f}),a.d(e,"i",function(){return v}),a.d(e,"a",function(){return g}),a.d(e,"c",function(){return y}),a.d(e,"j",function(){return b}),a.d(e,"m",function(){return _}),a.d(e,"o",function(){return D}),a.d(e,"n",function(){return x}),a.d(e,"k",function(){return T});var r=a("66df"),i=a("4328"),n=a.n(i),s=function(t){return r["a"].request({url:"analysis/dateentityscompare",data:t,method:"post"})},o=function(t){var e=t.time1,a=t.time2,i=t.bzid;return r["a"].request({url:"dwelltime/chart",params:{time1:e,time2:a,bzid:i},method:"get"})},l=function(t){var e=t.time1,a=t.time2,i=t.from_bzid,n=t.to_bzid,s=t.range;return r["a"].request({url:"crossFlow/index",params:{time1:e,time2:a,from_bzid:i,to_bzid:n,range:s},method:"get"})},c=function(t){var e=t.bzid,a=t.time;return r["a"].request({url:"flow/assoc",params:{bzid:e,time:a},method:"get"})},u=function(t){var e=t.bzid,a=t.time;return r["a"].request({url:"cross/direction",params:{bzid:e,time:a},method:"get"})},d=function(t){return r["a"].request({url:"stat/entityFlowBatch",params:t,method:"get"})},p=function(t){return r["a"].request({url:"dict/industry",params:t,method:"get"})},m=function(t){var e=t.time1,a=t.time2,i=t.industry_id,n=t.property_id;return r["a"].request({url:"shop/enterRate/top",params:{time1:e,time2:a,industry_id:i,property_id:n},method:"get"})},h=function(t){var e=t.time1,a=t.time2,i=t.bzid,n=t.range;return r["a"].request({url:"shop/enterRate/trend",params:{time1:e,time2:a,bzid:i,range:n},method:"get"})},f=function(t){var e=t.time,a=t.bzid;return r["a"].request({url:"flow/drainage",params:{time:e,bzid:a},method:"get"})},v=function(t){var e=t.time,a=t.property_id;return r["a"].request({url:"flow/moving",params:{time:e,property_id:a},method:"get"})},g=function(t){var e=t.time,a=t.property_id,i=t.start,n=t.end,s=t.floor_id;return r["a"].request({url:"judge/keyPath",params:{time:e,property_id:a,start:i,end:n,floor_id:s},method:"get"})},y=function(t){var e=t.date,a=t.property_id;return r["a"].request({url:"manager/query_active_target",params:{date:e,property_id:a},method:"get"})},b=function(t,e,a,i){return r["a"].request({url:"passflow/visits",data:{bzid:t,start_time:e,end_time:a,innerRange:i},method:"post"})},_=function(t){var e=t.time,a=t.bzid,i=t.timeRange;return r["a"].request({url:"analysis/heat_map",data:n.a.stringify({time:e,bzid:a,timeRange:i}),method:"post"})},D=function(t){var e=t.bzid,a=t.type,i=t.time;return r["a"].request({url:"judge/getIsFloat",params:{bzid:e,type:a,time:i},method:"get"})},x=function(t){var e=t.property_id,a=t.type;return r["a"].request({url:"judge/getHKBzids",params:{property_id:e,type:a},method:"get"})},T=function(t){var e=t.time1,a=t.range,i=t.from_bzids,n=t.to_bzids;return r["a"].request({url:"cross/trend",params:{time1:e,range:a,from_bzids:i,to_bzids:n},method:"get"})}},"99d7":function(t,e,a){"use strict";var r=a("36af"),i=a.n(r);i.a},a049:function(t,e,a){"use strict";var r=a("134d"),i=a.n(r);i.a},ce77:function(t,e,a){},d913:function(t,e,a){},e36f:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"time-selector"},[a("flow-selector",{ref:"flowSelector",attrs:{isShop:!0,isGate:!1,isFloor:!0,isStore:!0,footFall:!0,isArea:!0,isReset:!0,typeText:"dwellText",routName:t.dwellTime},on:{"on-change":t.paramsPrepare}})],1),a("div",{staticClass:"dewll_graph"},[t._m(0),a("div",{staticClass:"dwell-time-icon"},t._l(t.iconList,function(e,r){return a("span",{key:r,on:{click:function(a){t.iconClick(e.value)}}},[a("icons",{attrs:{title:t.iconTitle[e.type],type:e.type,size:20,color:t.iconIndex===e.value?t.iconColor:"#9D9D9DFF"}})],1)})),a("div",{staticClass:"dewll_graph_text"},[t.isGraph?a("vue-apex-charts",{ref:"graphBar",staticClass:"chartsStyleOne",class:{barActive:1==t.iconIndex},attrs:{height:"400",type:"bar",options:t.graphData.chartOptions,series:t.graphData.series}}):t._e(),t.isGraph?a("vue-apex-charts",{ref:"graphLine",staticClass:"chartsStyleTwo",class:{lineActive:0==t.iconIndex},attrs:{height:"400",width:"100%",type:"line",options:t.lineData.chartOptions,series:t.lineData.series}}):t._e(),a("div",{staticClass:"dewll_graph_text dwell-chart-table",class:{tableActive:2==t.iconIndex}},[a("dwell-table",{attrs:{columns:t.columnsList,data:t.chartTableList}})],1)],1)]),a("div",{staticClass:"dwell-time-table"},[a("table-default",{attrs:{tableTitle:t.tableTitle,tableName:t.tableName,tableList:t.tableList}})],1)])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dewll_graph_title"},[a("p",[t._v("停留时间分布")])])}],n=a("e814"),s=a.n(n),o=(a("c5f6"),a("a481"),a("7f7f"),a("2b0e")),l=a("d4a6"),c=a("63d9"),u=a("1321"),d=a.n(u),p=a("aa75"),m=a("94b0"),h=a("4ee1f"),f=(a("c1df"),a("2ef0")),v=a.n(f);o["default"].component(p["a"].name,p["a"]);var g={name:"DwellTime",components:{flowSelector:l["a"],VueApexCharts:d.a,TableDefault:c["a"],dwellTable:h["a"]},data:function(){var t=this;return{dwellTime:"dwellTime",tableTitle:"详细数据信息",isGraph:!1,isTableDate:!1,iconIndex:1,iconColor:"rgb(34, 128, 215)",iconList:[{type:"62",color:"#9D9D9DFF",value:1},{type:"biaoge-copy",color:"#9D9D9DFF",value:2}],iconTitle:{zhexiantu:"折线图",62:"柱状图","biaoge-copy":"详细数据",xiangxia:"查看全部实体排行",ditu:"出入口客流",fenxi:"饼状图",chakan:"查看所有"},graphData:{chartOptions:{chart:{toolbar:{show:!1,tools:{download:!1}},events:{}},plotOptions:{bar:{horizontal:!1,columnWidth:"45%",endingShape:"rounded"}},dataLabels:{enabled:!1},stroke:{show:!1,width:1,colors:["transparent"]},xaxis:{categories:[]},yaxis:{title:{text:"时间"},labels:{show:!0,formatter:function(e){return t.dateTiem(e)}}},fill:{opacity:1},tooltip:{y:{formatter:function(e){return t.dateTiem(e)}}}},series:[{name:"时间",data:[]}]},lineData:{chartOptions:{chart:{toolbar:{show:!1,tools:{download:!1}}},title:{text:""},stroke:{curve:"straight",width:2},dataLabels:{enabled:!1},colors:["#33B3ED","#2BD9CF","#94E2FF","#FBAB40","#8D82F0","#E8585A"],legend:{},yaxis:{title:{text:"时间"},labels:{show:!0,formatter:function(e){return t.dateTiem(e)}}},xaxis:{categories:[]},plotOptions:{bar:{horizontal:!1,endingShape:"rounded",columnWidth:"20%",radius:0}},tooltip:{y:{formatter:function(e){return t.dateTiem(e)}}}},series:[]},chartTableName:["实体名称","停留时间"],chartTableListL:[],tableName:["实体名称","实体类型","平均停留时间"],tableList:[],chartTableList:[],columnsList:[],prepareValue:"",compareData:""}},mounted:function(){var t=this;t.$refs.flowSelector.entityType="shop",this.isGraph=!0,this.iconIndex=1},activated:function(){},methods:{paramsPrepare:function(t){if(this.$store.state.home.headerAction&&0==t.entitys.length)return alert("请选择实体"),!1;try{var e="",a="",r=t.entitys.map(function(t){return t.name});"not"==t.compareType?(e="无对比",a=t.date1Array.join(",")):"entity"==t.compareType?(e="实体对比",a=t.date1Array.join(",")):"time"==t.compareType&&(e="时间对比",a=[t.date1Array.join(","),t.date2Array.join(",")]),window.TDAPP.onEvent("停留时间分析页面","数据查询",{"时间段":a,"对比方式":e,"实体选择":r})}catch(c){console.log("停留时间分析页面-数据查询-埋点error:"+c)}var i,n=t.date1Array[0]+","+t.date1Array[1];this.prepareValue=t;var s=!1;this.compareData=t,"time"===t.compareType?(this.isTableDate=!0,i=t.date2Array[0]+","+t.date2Array[1],t.date1Array[0]===t.date1Array[1]?s=t.date2Array[0]===t.date2Array[1]:this.charType=!1):(this.isTableDate=!1,i="",s=t.date1Array[0]===t.date1Array[1]);var o=[];if(t.entitys.map(function(t){o.push(t.id)}),o=v.a.remove(o,function(t){return 0!=t}).join(","),this.iconIndex=0,this.iconList=[],!0===s){var l=[{type:"62",color:"#9D9D9DFF",value:1},{type:"biaoge-copy",color:"#9D9D9DFF",value:2}];this.iconIndex=1,this.iconList=l}else{l=[{type:"zhexiantu",color:"#9D9D9DFF",value:0},{type:"62",color:"#9D9D9DFF",value:1},{type:"biaoge-copy",color:"#9D9D9DFF",value:2}];this.iconIndex=0,this.iconList=l}this.tableType(i),this.initialData(),this.dataList(n,i,o,s)},dataList:function(t,e,a,r){var i=this;Object(m["h"])({time1:t,time2:e,bzid:a}).then(function(t){i.graphData.chartOptions.xaxis.categories=[],t.data.data.charts.categories.map(function(t){i.graphData.chartOptions.xaxis.categories.push(t),i.lineData.chartOptions.xaxis.categories.push(t)}),0!==t.data.data.charts.series.length&&(i.graphData.series=t.data.data.charts.series,t.data.data.charts.series.map(function(t){var e={},a=t.name.replace(/,/g," - ");e.name=a,e.data=[],t.data.map(function(t,a){e.data.push(t)}),i.lineData.series.push(e)})),i.$refs.graphBar&&(i.$refs.graphBar.updateOptions({xaxis:i.graphData.chartOptions.xaxis}),i.graphData.chartOptions.xaxis.categories.length<2?(i.graphData.chartOptions.plotOptions.bar.columnWidth="10%",i.$refs.graphBar.updateOptions({plotOptions:i.graphData.chartOptions.plotOptions})):i.graphData.chartOptions.xaxis.categories.length<5?(i.graphData.chartOptions.plotOptions.bar.columnWidth="20%",i.$refs.graphBar.updateOptions({plotOptions:i.graphData.chartOptions.plotOptions})):(i.graphData.chartOptions.plotOptions.bar.columnWidth="70%",i.$refs.graphBar.updateOptions({plotOptions:i.graphData.chartOptions.plotOptions}))),i.$refs.graphLine&&i.$refs.graphLine.updateOptions({xaxis:{categories:i.lineData.chartOptions.xaxis.categories}}),i.chartTableData(t.data.data.charts.categories,t.data.data.charts.series,r),i.tableList=[],t.data.data.zones.map(function(t){var e={};e.name=t.name,e.type=null==t.type?"出入口":t.type,!1===i.isTableDate?e.time="":e.time=t.date?t.date:e.time=" ",e.avg=i.dateTiem(t.avg),i.tableList.push(e)})}).catch(function(t){console.log(t)})},iconClick:function(t){this.iconIndex=t},tableType:function(t){this.titleText=[],this.tableName=""===t?["实体名称","实体类型","平均停留时间"]:["实体名称","实体类型","时间点","平均停留时间"]},chartTableData:function(t,e,a){var r=this;if(r.columnsList=[{title:"时间",key:"time"}],r.chartTableList=[],!0===a){t.map(function(t,e){var a={};a.title=t,a.key="avg"+e,r.columnsList.push(a)});var i=r.compareData.compareType;e.map(function(t,e){var a={};if("time"===i){var n=Number(e)+1;a.time="第"+n+"天"}else a.time=r.compareData.date1Array[0];t.data.map(function(t,e){var i="avg"+e;a[i]=r.dateTiem(t)}),r.chartTableList.push(a)})}else e.map(function(t,e){var a={},i="avg"+e;a.title=t.name,a.key=i,r.columnsList.push(a)}),t.map(function(t,a){var i={};i.time=t,e.map(function(t,n){var s="avg"+n;i[s]=r.dateTiem(e[n].data[a])}),r.chartTableList.push(i)})},initialData:function(){var t=this;t.graphData.chartOptions.xaxis.categories=[],t.graphData.series=[],t.lineData.chartOptions.xaxis.categories=[],t.lineData.series=[],t.tableList=[]},dateTiem:function(t){var e,a,r=s()(t);return r>=60&&(e=s()(r/60),r=s()(r%60),e>=60&&(a=s()(e/60),e=s()(e%60))),r=r>0?r<10?"0"+s()(r):s()(r):"00",e=e>0?e<10?"0"+s()(e):s()(e):"00",a=a>0?a<10?"0"+s()(a):s()(a):"00",a+":"+e+":"+r}}},y=g,b=(a("109a"),a("a049"),a("2877")),_=Object(b["a"])(y,r,i,!1,null,null,null);e["default"]=_.exports}}]);