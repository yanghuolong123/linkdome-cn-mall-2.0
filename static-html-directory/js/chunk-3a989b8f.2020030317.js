(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a989b8f"],{1908:function(t,e,a){},"424d":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"holidayAnaysis"},[a("div",{staticClass:"box-card bg-white header",staticStyle:{"margin-bottom":"20px"}},[a("vs-select",{staticClass:"selectExample selects",attrs:{autocomplete:""},on:{change:function(e){t.yearChangeData(1)}},model:{value:t.selectYear,callback:function(e){t.selectYear=e},expression:"selectYear"}},t._l(t.years,function(t,e){return a("vs-select-item",{key:e,attrs:{value:t.value,text:t.key}})}),1),a("vs-select",{staticClass:"selectExample selects",attrs:{autocomplete:""},model:{value:t.selectHoliday,callback:function(e){t.selectHoliday=e},expression:"selectHoliday"}},t._l(t.holidays,function(t,e){return a("vs-select-item",{key:e,attrs:{value:t.value,text:t.key}})}),1),a("vs-button",{staticClass:"buttons",attrs:{color:"primary"},on:{click:t.handleSearch}},[t._v("查询")]),a("vs-button",{staticClass:"reset-buttons",attrs:{color:"primary"},on:{click:t.trendResetData}},[t._v("重置")])],1),a("HolidayAnalysis",{staticClass:"HolidayAnalysis",attrs:{series:t.series,type:t.type,options:t.options,columns:t.columns,tableList:t.tableList,dateTime:t.selectYear,pdfName:t.trendPdf,domId:t.idOne,selectHoliday:t.selectHoliday,ExcelData:t.trendExcel}}),a("div",{staticClass:"box-card bg-white header headerCompare",staticStyle:{"margin-bottom":"20px"}},[a("div",{staticClass:"flexs"},[a("vs-select",{staticClass:"selectExample selects",attrs:{autocomplete:""},on:{change:function(e){t.yearChangeData(2)}},model:{value:t.compareYear1,callback:function(e){t.compareYear1=e},expression:"compareYear1"}},t._l(t.years,function(t,e){return a("vs-select-item",{attrs:{value:t.value,text:t.key}})}),1),a("vs-select",{staticClass:"selectExample selects",attrs:{autocomplete:""},model:{value:t.compareHoliday1,callback:function(e){t.compareHoliday1=e},expression:"compareHoliday1"}},t._l(t.holidayActives1,function(t,e){return a("vs-select-item",{attrs:{value:t.value,text:t.key}})}),1)],1),a("div",{staticClass:"flexs"},[a("vs-select",{staticClass:"selectExample selects",attrs:{autocomplete:""},on:{change:function(e){t.yearChangeData(3)}},model:{value:t.compareYear2,callback:function(e){t.compareYear2=e},expression:"compareYear2"}},t._l(t.years,function(t,e){return a("vs-select-item",{attrs:{value:t.value,text:t.key}})}),1),a("vs-select",{staticClass:"selectExample selects",attrs:{autocomplete:""},model:{value:t.compareHoliday2,callback:function(e){t.compareHoliday2=e},expression:"compareHoliday2"}},t._l(t.holidayActives2,function(t,e){return a("vs-select-item",{attrs:{value:t.value,text:t.key}})}),1),a("vs-button",{staticClass:"buttons",attrs:{color:"primary"},on:{click:t.handleSearchCompare}},[t._v("查询")]),a("vs-button",{staticClass:"reset-buttons",attrs:{color:"primary"},on:{click:t.HolidaysResetData}},[t._v("重置")])],1)]),a("HolidayAnalysis",{staticClass:"HolidayAnalysis",attrs:{type:t.type,series:t.series2,options:t.options2,columns:t.columns2,tableList:t.tableList2,pdfName:t.contrastPdf,domId:t.idTwo,ExcelData:t.contrastExcel,title1:"节假日活动对比分析"}})],1)},n=[],s=(a("28a5"),a("6b54"),a("7514"),a("75fc")),o=a("795b"),l=a.n(o),r=(a("5df3"),a("ac6a"),a("7f7f"),a("c1df")),c=a.n(r),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"downloadList",on:{click:t.changeExportData}},[a("icons",{attrs:{type:"daoru",size:"20",title:"下载",color:"rgb(157, 157, 157)"}})],1),a("i-tabs",{staticClass:"chartsTable",model:{value:t.current,callback:function(e){t.current=e},expression:"current"}},[a("tab-item",{staticStyle:{position:"relative",left:"-9px"},attrs:{icon:t.icon1,titles:t.title1}},[a("div",{attrs:{id:t.domId}},[a("vue-apex-charts",{attrs:{type:t.type,height:t.height,options:t.options,series:t.series}})],1)]),a("tab-item",{attrs:{icon:t.icon2,titles:t.title2}},[a("TableMultipleSelected",{staticStyle:{height:"474px",overflow:"auto"},attrs:{tableName:t.columns,tableList:t.tableList}})],1)],1)],1)},u=[],h=(a("c5f6"),a("6d57")),p=a("1321"),y=a.n(p),f=a("693f"),m=a("776a"),v=a("66df"),b=function(t){return v["a"].request({url:"analysis/datecompare",data:t,method:"post"})},g=a("3191"),x=(a("bc3a"),{components:{VueApexCharts:y.a,tabItem:h["a"],iTabs:m["a"],TableMultipleSelected:f["a"]},props:{series:{type:Array,default:function(){return[]}},height:{type:String,default:"474px"},icon1:{type:String,default:"62"},icon2:{type:String,default:"biaoge-copy"},title1:{type:String,default:"趋势分析"},title2:{type:String,default:"详细数据"},type:{type:String,default:"line"},columns:{type:Array,default:function(){return[]}},dateTime:{type:Number},tableList:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){}},domId:{type:String,default:""},pdfName:{type:String,default:""},selectHoliday:{type:String,default:""},ExcelData:{type:Object,default:function(){}}},data:function(){return{current:0,reportName:""}},mounted:function(){},methods:{changeExportData:function(){var t,e,a=this,i=[];1==this.ExcelData.type?(e=""==this.selectHoliday?"name":"begin",t=[{title:this.columns[0],key:e},{title:this.columns[1],key:"enter"}]):t=[{title:this.columns[0],key:"name"},{title:this.columns[1],key:"begin"},{title:this.columns[2],key:"end"}];if(i.push(t),i.push(this.tableList),0==this.tableList.length)return alert("暂无数据可下载"),!1;Object(g["b"])(i).then(function(t){var e=new Date,i=new Blob([t.data]),n=1==a.ExcelData.type?"节假日活动趋势分析":"节假日活动对比分析",s=n+c()(e).format("YYYYMMDDHHmmss")+".xls",o=document.createElement("a");o.download=s,o.style.display="none",o.href=URL.createObjectURL(i),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)})}}}),A=x,k=(a("4a4f"),a("2877")),E=Object(k["a"])(A,d,u,!1,null,null,null),D=E.exports,w=a("e285"),H=a("c276"),Y={components:{HolidayAnalysis:D},data:function(){return{trendExcel:{type:1,enter:"enter",bzid:"",year:""},contrastExcel:{type:2,data:{}},idOne:"idOne",idTwo:"idTwo",trendPdf:"节假日活动趋势分析/",contrastPdf:"节假日活动对比分析/",type:"bar",years:[],entities:[],holidays:[],holidayActives1:[],holidayActives2:[],selectYear:(new Date).getFullYear(),compareYear1:(new Date).getFullYear(),compareYear2:(new Date).getFullYear(),compareHoliday1:"",compareHoliday2:"",selectEntity:"",selectEntity2:"",selectHoliday:"",targetData:[],AllHolidayData:[],current:0,year:"",bzids:[],columns:["节日","客流量"],columns2:["时间"],tableList:[],tableList2:[],series:[{name:"",data:[]}],series2:[],options0:{plotOptions:{bar:{horizontal:!1,endingShape:"rounded",columnWidth:"30%"}},chart:{height:505,zoom:{enabled:!1},toolbar:{show:!1}},colors:["#7467ED","#2BD9CF","#EA5455","#FF9F43","#1E1E1E"],dataLabels:{enabled:!1},stroke:{curve:"straight",width:2},title:{text:"",align:"left"},grid:{row:{colors:["#f3f3f3","transparent"],opacity:.5}},noData:{text:"暂无数据",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},xaxis:{categories:[]},yaxis:{title:{text:""},labels:{show:!0,formatter:function(t){return t.toLocaleString()}}},tooltip:{y:{formatter:function(t){return null===t?"":"客流量 "+t.toLocaleString()+"人"}}}},options2:{plotOptions:{bar:{horizontal:!1,endingShape:"rounded",columnWidth:"30%"}},chart:{height:505,zoom:{enabled:!1},toolbar:{show:!1}},colors:["#7367F0","#28C76F","#EA5455","#FF9F43","#1E1E1E"],dataLabels:{enabled:!1},stroke:{curve:"straight",width:2},title:{text:"",align:"left"},grid:{row:{colors:["#f3f3f3","transparent"],opacity:.5}},noData:{text:"暂无数据",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},xaxis:{categories:[]},yaxis:{title:{text:""},labels:{show:!0,formatter:function(t){return t.toLocaleString()}}},tooltip:{y:{formatter:function(t){return null===t?"":"客流量 "+t.toLocaleString()+"人"}}},markers:{size:5,hover:{sizeOffset:2}}},options:{colors:["#00A0E9","#7467ED","#EA5455","#FF9F43","#1E1E1E"],plotOptions:{bar:{horizontal:!1,endingShape:"rounded",columnWidth:"30%"}},dataLabels:{enabled:!1},stroke:{show:!1,width:2,colors:["transparent"]},xaxis:{categories:[]},yaxis:{title:{text:""},labels:{show:!0,formatter:function(t){return t.toLocaleString()}}},noData:{text:"暂无数据",align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},fill:{opacity:1},chart:{toolbar:{show:!1}},tooltip:{y:{formatter:function(t){return null===t?"":"客流量 "+t.toLocaleString()+"人"}}}}}},watch:{"$store.state.home.headerAction":function(){this.trendResetData(),this.HolidaysResetData();var t=this.$router.currentRoute.name;"HolidayAnalysis"===t&&this.init()}},computed:{},activated:function(){this.init()},mounted:function(){},methods:{init:function(){this.years=Object(H["w"])(),this.selectYear=c()().year(),this.compareYear1=c()().year(),this.compareYear2=c()().year(),this.initialApiData(),this.selectEntity="",this.selectEntity2="";var t=this.$store.state.home.bussinessTree,e=[],a=this.$store.state.home.headerAction;t.forEach(function(t,i){if(t.property_id==a){var n={};n.key=t.name,n.value=t.id,e.push(n)}}),this.entities=e,this.selectEntity=e[0].value,this.selectEntity2=e[0].value},initialApiData:function(){var t=this,e=this.selectYear,a=this.$store.state.home.headerAction;l.a.all([Object(w["l"])(e,20),Object(w["l"])(e,21,a)]).then(function(e){if(t.holidays=[],t.holidayActives1=[],t.holidayActives2=[],t.AllHolidayData=[],200==e[0].data.code){var a=e[0].data.data;t.holidays.push({key:"全部节假日活动",value:""}),a.map(function(e){t.AllHolidayData.push(e);var a={};a.value=e.id,a.key=e.name,t.holidays.push(a),t.holidayActives1.push(a),t.holidayActives2.push(a)}),t.selectHoliday=t.holidays[0]?t.holidays[0].value:"",setTimeout(function(){t.compareHoliday1=t.holidayActives1[0]?t.holidayActives1[0].value:"",t.compareHoliday2=t.holidayActives2[0]?t.holidayActives2[0].value:""})}if(200==e[1].data.code){var i=e[1].data.data;i.map(function(e){t.AllHolidayData.push(e);var a={};a.value=e.id,a.key=e.name,t.holidays.push(a),t.holidayActives1.push(a),t.holidayActives2.push(a)}),setTimeout(function(){t.handleSearch(),t.handleSearchCompare()})}})},yearChangeData:function(t){var e,a=this,i=this.$store.state.home.headerAction;switch(t){case 1:e=this.selectYear;break;case 2:e=this.compareYear1;break;case 3:e=this.compareYear2;break}l.a.all([Object(w["l"])(e,20),Object(w["l"])(e,21,i)]).then(function(i){if(200==i[0].data.code){var n=i[0].data.data,o=n.map(function(t){a.AllHolidayData.push(t);var e={};return e.value=t.id,e.key=t.name,e});switch(t){case 1:e=a.selectYear,a.holidays=[],a.holidays=[{key:"全部节假日活动",value:""}].concat(Object(s["a"])(o));break;case 2:e=a.compareYear1,a.holidayActives1=[],a.holidayActives1=o;break;case 3:e=a.compareYear2,a.holidayActives2=[],a.holidayActives2=o;break}}if(200==i[1].data.code){var l=i[1].data.data,r=l.map(function(t){a.AllHolidayData.push(t);var e={};return e.value=t.id,e.key=t.name,e});switch(t){case 1:a.holidays=[].concat(Object(s["a"])(a.holidays),Object(s["a"])(r)),a.selectHoliday=a.holidays[0]?a.holidays[0].value:"";break;case 2:a.holidayActives1=[].concat(Object(s["a"])(a.holidayActives1),Object(s["a"])(r)),a.compareHoliday1=a.holidayActives1[0]?a.holidayActives1[0].value:"";break;case 3:a.holidayActives2=[].concat(Object(s["a"])(a.holidayActives2),Object(s["a"])(r)),a.compareHoliday2=a.holidayActives2[0]?a.holidayActives2[0].value:"";break}}})},handleSearch:function(){var t=this.selectYear,e=this.selectEntity,a=this.selectHoliday,i=this;if(t)if(e){try{var n=_.find(this.holidays,["value",this.selectHoliday]);n=n&&n.key?n.key:"",window.TDAPP.onEvent("节假日活动分析页面","趋势分析查询",{"时间段":t.toString(),"节假日活动选择":n})}catch(d){console.log("节假日活动分析页面-趋势分析查询-埋点error:"+d)}if(a){var s,o=_.find(this.AllHolidayData,{id:this.selectHoliday}),l=Object(H["j"])([o.begin,o.end]),r=o.begin+","+o.end,c={type:"enter",bzid:e,innerRange:l,range:r};i.trendExcel.bzid=e,i.trendExcel.year="",i.trendExcel.innerRange=l,i.trendExcel.range=r,Object(g["s"])(c).then(function(t){s="1h"==l?t.data.data.map(function(t){return t.begin.split(" ")[1]}):t.data.data.map(function(t){return t.begin.split(" ")[0]});var e=t.data.data.map(function(t){return t.enter}),a=_.cloneDeep(i.options);a.xaxis.categories=s;var n="30%";s.length&&(n=s.length<5?"20%":"70%"),a.plotOptions.bar.columnWidth=n,i.options=a,i.series[0].data=e;var o=t.data.data,r=[];o.forEach(function(t){var e={};e.begin="1h"==l?t.begin.split(" ")[1]:t.begin.split(" ")[0],e.enter=0==t.enter?" ":t.enter.toLocaleString()+"人",r.push(e)}),i.columns=["日期","客流量"],i.tableList=r})}else i.trendExcel.bzid=e,i.trendExcel.year=t,i.trendExcel.innerRange="",i.trendExcel.range="",Object(w["p"])("enter",e,t).then(function(t){var e=t.data.data.map(function(t){return t.name}),a=t.data.data.map(function(t){return t.enter}),n=_.cloneDeep(i.options);n.xaxis.categories=e;var s="30%";e.length&&(s=e.length<5?"20%":"70%"),n.plotOptions.bar.columnWidth=s,i.options=n,i.series[0].data=a;var o=t.data.data;o.forEach(function(t){t.enter=0==t.enter?" ":t.enter.toLocaleString()+"人"}),i.tableList=o,i.columns=["节日","客流量"]})}else alert("请选择购物中心");else alert("请选择年份")},handleSearchCompare:function(){var t=this;t.columns2=["时间"];var e=_.find(this.AllHolidayData,{id:this.compareHoliday1}),a=_.find(this.AllHolidayData,{id:this.compareHoliday2});if(e&&a){var i={begin:e.begin,end:e.end},n={begin:a.begin,end:a.end},s={date1:{begin:i.begin,end:i.end},date2:{begin:n.begin,end:n.end},type:"enter",bzid:this.selectEntity};t.columns2.push(e.name),t.columns2.push(a.name),t.contrastExcel.data=s;try{var o=_.find(this.holidayActives1,["value",this.compareHoliday1]);o=o&&o.key?o.key:"";var l=_.find(this.holidayActives2,["value",this.compareHoliday2]);l=l&&l.key?l.key:"",window.TDAPP.onEvent("节假日活动分析页面","对比查询",{"时间段":[this.compareYear1,this.compareYear2],"节假日活动选择":[o,l]})}catch(r){console.log("节假日活动分析页面-对比查询-埋点error:"+r)}b(s).then(function(i){var n=i.data.data,s=[];n.forEach(function(t,e){s.push("第"+(e+1)+"天")});var o=[];o=c()(e.begin).isAfter(c()(new Date))?n.map(function(t,e){return""}):n.map(function(t,e){return t.date1.enter?t.date1.enter:0});var l=[];l=c()(a.begin).isAfter(c()(new Date))?n.map(function(t,e){return""}):n.map(function(t){return t.date2.enter?t.date2.enter:0});var r=[{name:"",data:[]},{name:"",data:[]}];r[0].name=e.name,r[0].smooth=!0,r[0].data=o,r[1].name=a.name,r[1].smooth=!0,r[1].data=l,t.series2=r;var d=_.cloneDeep(t.options0);d.xaxis.categories=s;var u="30%";s.length&&(u=s.length<5?"20%":"70%"),d.plotOptions.bar.columnWidth=u,t.options2=d;var h=[];o.forEach(function(t,e){var a={};a.name=s[e]?s[e]:" ",a.begin=t||0===t?t.toLocaleString()+"人"||!1:" ",a.end=l[e]||0===l[e]?l[e].toLocaleString()+"人":" ",h.push(a)}),t.tableList2=h})}},trendResetData:function(){try{window.TDAPP.onEvent("节假日活动分析页面","趋势分析重置",{})}catch(t){console.log("节假日活动分析页面-趋势分析重置-埋点error:"+t)}this.selectHoliday=this.holidays[0].value,this.selectYear=(new Date).getFullYear()},HolidaysResetData:function(){try{window.TDAPP.onEvent("节假日活动分析页面","对比重置",{})}catch(t){console.log("节假日活动分析页面-对比重置-埋点error:"+t)}this.compareYear1=(new Date).getFullYear(),this.compareYear2=(new Date).getFullYear(),this.compareHoliday1=this.holidayActives1[0].value,this.compareHoliday2=this.holidayActives2[0].value}}},C=Y,L=(a("4ecc"),Object(k["a"])(C,i,n,!1,null,null,null));e["default"]=L.exports},"4a4f":function(t,e,a){"use strict";var i=a("969b"),n=a.n(i);n.a},"4ecc":function(t,e,a){"use strict";var i=a("9310"),n=a.n(i);n.a},"6d57":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tabitem"},[t._t("default")],2)},n=[],s={name:"TabItem",mounted:function(){var t=this;this.$nextTick(function(){t.updateNav()})},methods:{updateNav:function(){this.$parent.updateNav()}},destroyed:function(){var t=this;this.$nextTick(function(){t.updateNav()})}},o=s,l=(a("e4be"),a("2877")),r=Object(l["a"])(o,i,n,!1,null,"d833551c",null);e["a"]=r.exports},"776a":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-box"},[a("div",{staticClass:"tab-bar"},[a("div",{staticClass:"tab-bar-left"},[t.isNowTime?[a("span",[t._v(t._s(t.date))]),a("span",[t._v(t._s(t.time))])]:a("span",[t._v("\n        "+t._s(t.titleList[t.value])+"\n        "),"新老顾客占比"==t.titleList[0]?a("Tooltip",{attrs:{content:t.tootipText,placement:"bottom",theme:"light",transfer:"","max-width":"600"}},[a("icons",{attrs:{type:"wenhao"}})],1):t._e()],1)],2),a("div",{staticClass:"tab-bar-right"},[t._t("select"),a("ul",[t._l(t.navList,function(e,i){return a("li",{key:i,attrs:{title:t.iconTitle[e.icon]?t.iconTitle[e.icon]:""},on:{click:function(a){t.handleClick(i,e)}}},[a("span",{staticClass:"navitemIcon"},[a("icons",{attrs:{type:e.icon,size:20,color:t.currentIndex===i?t.iconColor:"#9D9D9DFF"}})],1)])}),t._t("export")],2)],2)]),a("div",{staticClass:"tab-con",style:t.contentStyle},[t._t("default")],2)])},n=[],s=(a("28a5"),a("ac6a"),a("7f7f"),a("c5f6"),a("c1df")),o=a.n(s),l={name:"tabs",props:{value:{type:Number,default:0},iconColor:{type:String,default:"#2280D7"},isNowTime:{type:Boolean,default:!1},exportXls:{type:Boolean,default:!1}},data:function(){return{tootipText:"新顾客：在所选时间段内仅来过1次的人数\n老顾客：在所选时间段内来过2次及以上的人数",navList:[],titleList:[],currentIndex:0,iconTitle:{zhexiantu:"折线图",62:"柱状图","biaoge-copy":"详细数据",xiangxia:"查看全部实体排行",ditu:"出入口客流",fenxi:"饼状图",chakan:"查看所有"},date:"",time:""}},mounted:function(){var t=this;this.isNowTime&&setInterval(function(){t.formatTime()},1e3)},computed:{contentStyle:function(){var t={};return t={transform:"translateX(-".concat(this.value,"00%)")},t}},methods:{getTabs:function(){return this.$children.filter(function(t){return"TabItem"===t.$options.name})},updateNav:function(){var t=this;this.navList=[],this.titleList=[];var e=this.$slots.default.filter(function(t){return void 0!==t.data});e.forEach(function(e,a){e.data.attrs&&(t.navList.push({label:e.data.attrs.label||"",icon:e.data.attrs.icon||"",name:a}),t.titleList.push(e.data.attrs.titles||""),t.handleClick(0))})},handleClick:function(t,e){this.currentIndex=t,this.$emit("input",t),this.$emit("on-click",t,e)},formatTime:function(){var t=o()().format("YYYY-MM-DD HH:mm:ss").split(" ");this.date=t[0],this.time=t[1]}}},r=l,c=(a("a6b3"),a("2877")),d=Object(c["a"])(r,i,n,!1,null,"8df506a6",null);e["a"]=d.exports},9310:function(t,e,a){},"969b":function(t,e,a){},a6b3:function(t,e,a){"use strict";var i=a("1908"),n=a.n(i);n.a},d641:function(t,e,a){},e4be:function(t,e,a){"use strict";var i=a("d641"),n=a.n(i);n.a}}]);